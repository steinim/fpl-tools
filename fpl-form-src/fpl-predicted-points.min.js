const loops=Math.min(count-1,5),availcol=$("th.availability").index();if(38==lw)var ordercol=10;else ordercol=8;const columns=8+Math.min(2,2*(38-lw))+3*(38-lw)+9,colVisText=["Select","Player",'<i class="fas fa-mouse-pointer"></i> for Info',"Team","Position","Cost","Form","Prob. of Appearing","Points So Far","Official Chance","Official Availability","Selected By %","Transfers In GW","Transfers Out GW","News"];$.fn.dataTable.ext.order["dom-checkbox"]=function(e,l){return this.api().column(l,{order:"index"}).nodes().map((function(e,l){return $(e).closest("tr").hasClass("selected")?"1":"0"}))},$(document).ready((function(){var e=$("#players").DataTable({dom:"PrfBitp",searchPanes:{layout:"columns-5",dtOpts:{searching:!1,ordering:!1},orderable:!1,cascadePanes:!0,panes:[{header:"Team",options:[{label:"Arsenal, ARS",value:function(e,l){return"ARS"===e[3]},className:"ars"},{label:"Aston Villa, AVL",value:function(e,l){return"AVL"===e[3]},className:"avl"},{label:"Bournemouth, BOU",value:function(e,l){return"BOU"===e[3]},className:"bou"},{label:"Brentford, BRE",value:function(e,l){return"BRE"===e[3]},className:"bre"},{label:"Brighton, BHA",value:function(e,l){return"BHA"===e[3]},className:"bha"},{label:"Chelsea, CHE",value:function(e,l){return"CHE"===e[3]},className:"che"},{label:"Crystal Palace, CRY",value:function(e,l){return"CRY"===e[3]},className:"cry"},{label:"Everton, EVE",value:function(e,l){return"EVE"===e[3]},className:"eve"},{label:"Fulham, FUL",value:function(e,l){return"FUL"===e[3]},className:"ful"},{label:"Ipswich, IPS",value:function(e,l){return"IPS"===e[3]},className:"ips"},{label:"Leicester, LEI",value:function(e,l){return"LEI"===e[3]},className:"lei"},{label:"Liverpool, LIV",value:function(e,l){return"LIV"===e[3]},className:"liv"},{label:"Man City, MCI",value:function(e,l){return"MCI"===e[3]},className:"mci"},{label:"Man Utd, MUN",value:function(e,l){return"MUN"===e[3]},className:"mun"},{label:"Newcastle, NEW",value:function(e,l){return"NEW"===e[3]},className:"new"},{label:"Nottm Forest, NFO",value:function(e,l){return"NFO"===e[3]},className:"nfo"},{label:"Southampton, SOU",value:function(e,l){return"SOU"===e[3]},className:"sou"},{label:"Spurs, TOT",value:function(e,l){return"TOT"===e[3]},className:"tot"},{label:"West Ham, WHU",value:function(e,l){return"WHU"===e[3]},className:"whu"},{label:"Wolves, WOL",value:function(e,l){return"WOL"===e[3]},className:"wol"}]},{header:"Position",options:[{label:"Goalkeepers, GK",value:function(e,l){return"GK"===e[4]},className:"gk"},{label:"Defenders, DEF",value:function(e,l){return"DEF"===e[4]},className:"def"},{label:"Midfielders, MID",value:function(e,l){return"MID"===e[4]},className:"mdf"},{label:"Forwards, FWD",value:function(e,l){return"FWD"===e[4]},className:"fwd"},{label:"Goalkeepers & Defenders",value:function(e,l){return"GK"===e[4]||"DEF"===e[4]},className:"gkdef"},{label:"Midfielders & Forwards",value:function(e,l){return"MID"===e[4]||"FWD"===e[4]},className:"midfwd"},{label:"All Except Goalkeepers",value:function(e,l){return"DEF"===e[4]||"MID"===e[4]||"FWD"===e[4]},className:"defmidfwd"}]},{header:"Max Cost",options:[{label:"15.5",value:function(e,l){return e[5]<=15.5},className:"r1"},{label:"13.0",value:function(e,l){return e[5]<=13},className:"r1"},{label:"11.0",value:function(e,l){return e[5]<=11},className:"r1"},{label:"10.5",value:function(e,l){return e[5]<=10.5},className:"r1"},{label:"10.0",value:function(e,l){return e[5]<=10},className:"r1"},{label:"9.9",value:function(e,l){return e[5]<=9.9},className:"r2"},{label:"9.8",value:function(e,l){return e[5]<=9.8},className:"r2"},{label:"9.7",value:function(e,l){return e[5]<=9.7},className:"r2"},{label:"9.6",value:function(e,l){return e[5]<=9.6},className:"r2"},{label:"9.5",value:function(e,l){return e[5]<=9.5},className:"r2"},{label:"9.4",value:function(e,l){return e[5]<=9.4},className:"r2"},{label:"9.3",value:function(e,l){return e[5]<=9.3},className:"r2"},{label:"9.2",value:function(e,l){return e[5]<=9.2},className:"r2"},{label:"9.1",value:function(e,l){return e[5]<=9.1},className:"r2"},{label:"9.0",value:function(e,l){return e[5]<=9},className:"r2"},{label:"8.9",value:function(e,l){return e[5]<=8.9},className:"r3"},{label:"8.8",value:function(e,l){return e[5]<=8.8},className:"r3"},{label:"8.7",value:function(e,l){return e[5]<=8.7},className:"r3"},{label:"8.6",value:function(e,l){return e[5]<=8.6},className:"r3"},{label:"8.5",value:function(e,l){return e[5]<=8.5},className:"r3"},{label:"8.4",value:function(e,l){return e[5]<=8.4},className:"r3"},{label:"8.3",value:function(e,l){return e[5]<=8.3},className:"r3"},{label:"8.2",value:function(e,l){return e[5]<=8.2},className:"r3"},{label:"8.1",value:function(e,l){return e[5]<=8.1},className:"r3"},{label:"8.0",value:function(e,l){return e[5]<=8},className:"r3"},{label:"7.9",value:function(e,l){return e[5]<=7.9},className:"r4"},{label:"7.8",value:function(e,l){return e[5]<=7.8},className:"r4"},{label:"7.7",value:function(e,l){return e[5]<=7.7},className:"r4"},{label:"7.6",value:function(e,l){return e[5]<=7.6},className:"r4"},{label:"7.5",value:function(e,l){return e[5]<=7.5},className:"r4"},{label:"7.4",value:function(e,l){return e[5]<=7.4},className:"r4"},{label:"7.3",value:function(e,l){return e[5]<=7.3},className:"r4"},{label:"7.2",value:function(e,l){return e[5]<=7.2},className:"r4"},{label:"7.1",value:function(e,l){return e[5]<=7.1},className:"r4"},{label:"7.0",value:function(e,l){return e[5]<=7},className:"r4"},{label:"6.9",value:function(e,l){return e[5]<=6.9},className:"r5"},{label:"6.8",value:function(e,l){return e[5]<=6.8},className:"r5"},{label:"6.7",value:function(e,l){return e[5]<=6.7},className:"r5"},{label:"6.6",value:function(e,l){return e[5]<=6.6},className:"r5"},{label:"6.5",value:function(e,l){return e[5]<=6.5},className:"r5"},{label:"6.4",value:function(e,l){return e[5]<=6.4},className:"r5"},{label:"6.3",value:function(e,l){return e[5]<=6.3},className:"r5"},{label:"6.2",value:function(e,l){return e[5]<=6.2},className:"r5"},{label:"6.1",value:function(e,l){return e[5]<=6.1},className:"r5"},{label:"6.0",value:function(e,l){return e[5]<=6},className:"r5"},{label:"5.9",value:function(e,l){return e[5]<=5.9},className:"r6"},{label:"5.8",value:function(e,l){return e[5]<=5.8},className:"r6"},{label:"5.7",value:function(e,l){return e[5]<=5.7},className:"r6"},{label:"5.6",value:function(e,l){return e[5]<=5.6},className:"r6"},{label:"5.5",value:function(e,l){return e[5]<=5.5},className:"r6"},{label:"5.4",value:function(e,l){return e[5]<=5.4},className:"r6"},{label:"5.3",value:function(e,l){return e[5]<=5.3},className:"r6"},{label:"5.2",value:function(e,l){return e[5]<=5.2},className:"r6"},{label:"5.1",value:function(e,l){return e[5]<=5.1},className:"r6"},{label:"5.0",value:function(e,l){return e[5]<=5},className:"r6"},{label:"4.9",value:function(e,l){return e[5]<=4.9},className:"r7"},{label:"4.8",value:function(e,l){return e[5]<=4.8},className:"r7"},{label:"4.7",value:function(e,l){return e[5]<=4.7},className:"r7"},{label:"4.6",value:function(e,l){return e[5]<=4.6},className:"r7"},{label:"4.5",value:function(e,l){return e[5]<=4.5},className:"r7"},{label:"4.4",value:function(e,l){return e[5]<=4.4},className:"r7"},{label:"4.3",value:function(e,l){return e[5]<=4.3},className:"r8"},{label:"4.2",value:function(e,l){return e[5]<=4.2},className:"r8"},{label:"4.1",value:function(e,l){return e[5]<=4.1},className:"r8"},{label:"4.0",value:function(e,l){return e[5]<=4},className:"r8"},{label:"3.9",value:function(e,l){return e[5]<=3.9},className:"r8"}]},{header:"Min Prob of Appearing",options:[{label:">0.9 - Highly Likely",value:function(e,l){return e[7]>=.9},className:"t1"},{label:">0.8 - Surprised if doesn't",value:function(e,l){return e[7]>=.8},className:"t2"},{label:">0.5 - Don't blame me",value:function(e,l){return e[7]>=.5},className:"t3"},{label:">0.2 - Better have good subs",value:function(e,l){return e[7]>=.2},className:"t4"},{label:">0.01 - You never know",value:function(e,l){return e[7]>.01},className:"t5"},{label:">0 - Pigs might fly",value:function(e,l){return e[7]>0},className:"t6"},{label:"0 - You're desperate",value:function(e,l){return e[7]>=0},className:"t7"}],preSelect:["0 - You're desperate"]},{header:"Official Availability",options:[{label:"Available",value:function(e,l){return"Available"===e[availcol]},className:"available"},{label:"Doubtful, 75%",value:function(e,l){return"75"===e[availcol-1]},className:"p75"},{label:"Doubtful, 50%",value:function(e,l){return"50"===e[availcol-1]},className:"p50"},{label:"Doubtful, 25%",value:function(e,l){return"25"===e[availcol-1]},className:"p25"},{label:"Injured, 0%",value:function(e,l){return"Injured"===e[availcol]},className:"inj"},{label:"Suspended, 0%",value:function(e,l){return"Suspended"===e[availcol]},className:"sus"},{label:"Ineligible, 0%",value:function(e,l){return"Ineligible"===e[availcol]},className:"ineligible"},{label:"Unavailable, 0%",value:function(e,l){return"Unavailable"===e[availcol]},className:"unavailable"}]}]},language:{searchPanes:{collapseMessage:"Hide Filters",showMessage:"Show Filters"},search:"",searchPlaceholder:"Search Players",info:"",infoEmpty:"",infoFiltered:"",zeroRecords:"No matching players found. Change some filters.",select:{rows:{_:"%d players selected",0:"Click cells to select players",1:"1 player selected",10:"10 players selected (5 fewer than squad size)",11:"11 players selected (4 fewer than squad size)",12:"12 players selected (3 fewer than squad size)",13:"13 players selected (2 fewer than squad size)",14:"14 players selected (1 fewer than squad size)",15:"15 players selected (correct squad size)",16:"16 players selected (1 more than squad size)",17:"17 players selected (2 more than squad size)",18:"18 players selected (3 more than squad size)",19:"19 players selected (4 more than squad size)",20:"20 players selected (5 more than squad size)"}}},paging:!1,fixedColumns:{left:3},fixedHeader:{footer:!0},colReorder:!0,order:[[ordercol,"desc"]],orderClasses:!0,columnDefs:[{searchPanes:{show:!1},targets:"_all"},{orderSequence:["desc"],targets:["desc_only"]},{orderSequence:["asc"],targets:["asc_only"]},{orderable:!1,targets:["no_order"]},{className:"select-checkbox",targets:0,orderDataType:"dom-checkbox"},{width:"25px",targets:0},{width:"30px",targets:"pp"},{width:"35px",targets:2},{width:"40px",targets:[3,4,5,6,"ppnxt"]},{width:"45px",targets:"val"},{width:"50px",targets:["col-pps","vals","psf"]},{width:"55px",targets:"chance"},{width:"60px",targets:[7,"selby"]},{width:"65px",targets:["trfin","trfout"]},{width:"85px",targets:"availability"},{width:"320px",targets:"news"}],buttons:[{text:"Load My Squad",action:function(){!function(){if("undefined"!=typeof myTeam){$("#players").DataTable().searchPanes.clearSelections(),e.search("").draw(),i();for(let l=0;l<15;l++){let a=myTeam.picks[l].element;e.rows(`.${a}`).select()}o()}else window.location.href="../load-fpl-squad.php"}()}},{text:"Deselect All Players",action:function(){i()}},{extend:"columnToggle",columns:".val",className:"buttval",text:"Values"},{extend:"columnToggle",columns:".ppnxt",className:"buttppn",text:"PP Next"},{extend:"colvis",text:"Other Columns",columns:":not(.select, .player, .team, .position, .price, .pp, .val, .ppnxt, .col-pps, .vals)",columnText:function(e,l){return l<8?colVisText[l]:colVisText[columns-21+l]}},{extend:"colvisGroup",text:"Show All",show:":hidden"}],select:{style:"multi"}});$("#players_filter input").prop("id","search"),$("#players_filter label").attr("for","search");var l=0,a=0,r=0,n=[];sumpp=new Array(Math.max(count-1,0)).fill(0);var u=[];sumppn=new Array(Math.max(loops,0)).fill(0),sumval=new Array(Math.max(loops,0)).fill(0);var c=0;function o(){for(l=15,$(".tselected").html("15"),a=e.rows({selected:!0}).data().pluck(5).sum(),$(".tprice").html(a.toFixed(1)),r=e.rows({selected:!0}).data().pluck(9).sum(),$(".tpp1").html(r.toFixed(1)),q=0;q<loops;q++)sumpp[q]=e.rows({selected:!0}).data().pluck(11+3*q).sum(),sumppn[q]=e.rows({selected:!0}).data().pluck(12+3*q).sum(),$(".tpp"+(q+2)).html(sumpp[q].toFixed(1)),$(".tppn"+(q+2)).html(sumppn[q].toFixed(1));var t=e.rows({selected:!0}).indexes();c=e.cells(t,".col-pps").data().sum(),$(".tpps").html(c.toFixed(0)),$(this).toggleClass("selected"),e.columns.adjust(),setTimeout(removeLoader,500)}if($("#players tbody").on("click",".info",(e=>{e.stopPropagation()})),$("#players tbody").on("click","tr",(function(){var t=parseFloat($(this).find(".price").html().replace(/[$,]/g,""));if(38!=lw)var s=parseFloat($(this).find(".pp1").html().replace(/[$,]/g,""));var o=parseFloat($(this).find(".pps").html().replace(/[$,]/g,""));$(this).hasClass("selected")?(l-=1,a-=t,r-=s,c-=o):(l+=1,a+=t,r+=s,c+=o);for($(".tselected").html(l),$(".tprice").html(Math.abs(a).toFixed(1)),$(".tpp1").html(Math.abs(r).toFixed(1)),$(".tpps").html(c.toFixed(0)),q=0;q<loops;q++)n[q]=parseFloat($(this).find(".pp"+(q+2)).html().replace(/[$,]/g,"")),u[q]=parseFloat($(this).find(".ppn"+(q+2)).html().replace(/[$,]/g,"")),$(this).hasClass("selected")?(sumpp[q]-=n[q],sumppn[q]-=u[q]):(sumpp[q]+=n[q],sumppn[q]+=u[q]),$(".tpp"+(q+2)).html(Math.abs(sumpp[q]).toFixed(1)),$(".tppn"+(q+2)).html(Math.abs(sumppn[q]).toFixed(1));$(this).toggleClass("selected"),e.columns.adjust()})),"undefined"!=typeof myTeam){for(let l=0;l<15;l++){let a=myTeam.picks[l].element;e.rows(`.${a}`).select()}o()}function i(){for(l=0,$(".tselected").html("0"),a=0,$(".tprice").html("0"),r=0,$(".tpp1").html("0"),t=0;t<loops;t++)sumpp[t]=0,$(".tpp"+(t+2)).html("0");for(s=0;s<loops;s++)sumppn[s]=0,$(".tppn"+(s+2)).html("0");c=0,$(".tpps").html("0"),e.rows().deselect(),e.columns.adjust()}e.on("draw.dt",(function(){""!==e.search()&&($("button.dtsp-clearAll").removeClass("dtsp-disabledButton"),$("button.dtsp-clearAll").removeAttr("disabled"))})),$("button.dtsp-clearAll").on("click",(function(){e.search("").draw()}))}));
